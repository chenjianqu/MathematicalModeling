% b=3% 
function aaa()
clear;
clc;

r=0.0;
f1=zeros(1,13);
for i=1:12
    f1(1,i)=-(0.8*r-i*r/15-0.159);
end
f1(1,13)=-1.908;

H=[1,0,0,0,0,0,0,0,0,0,0,0,0;
    0,1,0,0,0,0,0,0,0,0,0,0,0;
    0,0,1,0,0,0,0,0,0,0,0,0,0;
    0,0,0,1,0,0,0,0,0,0,0,0,0;
    0,0,0,0,1,0,0,0,0,0,0,0,0;
    0,0,0,0,0,1,0,0,0,0,0,0,0;
    0,0,0,0,0,0,1,0,0,0,0,0,0;
    0,0,0,0,0,0,0,1,0,0,0,0,0;
    0,0,0,0,0,0,0,0,1,0,0,0,0;
    0,0,0,0,0,0,0,0,0,1,0,0,0;
    0,0,0,0,0,0,0,0,0,0,1,0,0;
    0,0,0,0,0,0,0,0,0,0,0,1,0;
    0,0,0,0,0,0,0,0,0,0,0,0,12].*(-3.26*(10^(-6)));
%f=[-0.1503;-0.1497;-0.149;-0.1483;-0.1488;-0.147;-0.1463;-0.1457;-0.145;-0.1443;-0.1437;-0.143;-1.908;];
f=f1';
b=119000;
A=[1,1,1,1,1,1,0,0,0,0,0,0,0];
beq=116000;
Aeq=[1,1,1,1,1,1,1,1,1,1,1,1,12];
lb=[0;0;0;0;0;0;0;0;0;0;0;0;0];
ub=[36500;36500;36500;36500;36500;36500;36500;36500;36500;36500;36500;36500;352525];

%n=(quadprog(-H,-f,A,b,Aeq,beq,lb,ub))'
NVAR=13;
%n(1,1:12)=n(1,1:12)+3500;

n=[12490 12490 12490 12490 12490 12490 6944 6944 6944 6944 6944 6944 6944];
Eval(n)
n(1,1:12)
sum(n(1,1:12))+n(1,13)*12


%计算适应度
function out=Eval(s)
salary_at=zeros(NVAR,1);
ra=0.00;
%计算税后工资
for evi=1:NVAR
    x=s(1,evi);
    if x>38500
        salary_at(1,evi)=x-(45+300+900+6500)-(x-38500)*0.30;
    elseif x>12500
        salary_at(1,evi)=x-(45+300+900)-(x-12500)*0.25;
    elseif x>8000
        salary_at(1,evi)=x-(45+300)-(x-8000)*0.20;
    elseif x>5000
        salary_at(1,evi)=x-45-(x-5000)*0.1;
    elseif x>3500
        salary_at(1,evi)=x-(x-3500)*0.03;
    else
        salary_at(1,evi)=x;
    end
end
%计算到年底的总收入
out=(1+ra*11/12)*0.8*salary_at(1,1)+0.2*salary_at(1,1)...
+(1+ra*10/12)*0.8*salary_at(1,2)+0.2*salary_at(1,2)...
+(1+ra*9/12)*0.8*salary_at(1,3)+0.2*salary_at(1,3)...
+(1+ra*8/12)*0.8*salary_at(1,4)+0.2*salary_at(1,4)...
+(1+ra*7/12)*0.8*salary_at(1,5)+0.2*salary_at(1,5)...
+(1+ra*6/12)*0.8*salary_at(1,6)+0.2*salary_at(1,6)...
+(1+ra*5/12)*0.8*salary_at(1,7)+0.2*salary_at(1,7)...
+(1+ra*4/12)*0.8*salary_at(1,8)+0.2*salary_at(1,8)...
+(1+ra*3/12)*0.8*salary_at(1,9)+0.2*salary_at(1,9)...
+(1+ra*2/12)*0.8*salary_at(1,10)+0.2*salary_at(1,10)...
+(1+ra*1/12)*0.8*salary_at(1,11)+0.2*salary_at(1,11)...
+salary_at(1,12)+salary_at(1,13)*12;

end

end
